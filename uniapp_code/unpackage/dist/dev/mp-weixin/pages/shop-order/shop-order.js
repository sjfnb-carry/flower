(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shop-order/shop-order"],{155:function(e,t,n){"use strict";(function(e,t){var r=n(4);n(26);r(n(25));var a=r(n(156));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n(1)["default"],n(2)["createPage"])},156:function(e,t,n){"use strict";n.r(t);var r=n(157),a=n(159);for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n(161);var u,c=n(32),o=Object(c["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,null,null,!1,r["components"],u);o.options.__file="pages/shop-order/shop-order.vue",t["default"]=o.exports},157:function(e,t,n){"use strict";n.r(t);var r=n(158);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},158:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return u})),n.d(t,"recyclableRender",(function(){return s})),n.d(t,"components",(function(){return r}));try{r={mescrollUni:function(){return Promise.all([n.e("common/vendor"),n.e("components/mescroll-uni/mescroll-uni")]).then(n.bind(null,359))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.user.id?e.__map(e.list,(function(t,n){var r=e.__get_orig(t),a=1==t.type||3==t.type?e.priceChange(t.price):null,s=2==t.type?e.priceChange(t.price):null,u=1==t.type||3==t.type?e.priceChange(t.total):null;return{$orig:r,m0:a,m1:s,m2:u}})):null);e.$mp.data=Object.assign({},{$root:{l0:n}})},s=!1,u=[];a._withStripped=!0},159:function(e,t,n){"use strict";n.r(t);var r=n(160),a=n.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(s);t["default"]=a.a},160:function(e,t,n){"use strict";(function(e){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(55)),s=r(n(57)),u={data:function(){return{navlist:["全部","未支付","拼团中","已支付","已发货","已完成","已取消","已退款"],currentIndex:0,pages:1,list:[],mescroll:null,downOption:{auto:!1},upOption:{page:{},noMoreSize:3,textNoMore:"~ 没有更多了 ~"},hasNext:!0,status:"",user:""}},computed:{baseUrl:function(){return this.$base.url}},onShow:function(){var t=this;return(0,s.default)(a.default.mark((function n(){var r,s;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.getStorageSync("nowTable"),n.next=3,t.$api.session(r);case 3:s=n.sent,t.user=s.data,t.hasNext=!0,t.mescroll&&t.mescroll.resetUpScroll();case 7:case"end":return n.stop()}}),n)})))()},methods:{navselect:function(e,t){this.currentIndex=e,this.status="全部"==t?"":"已支付"==t?"已支付":t,this.hasNext=!0,this.mescroll&&this.mescroll.resetUpScroll()},priceChange:function(e){return Number(e).toFixed(2)},mescrollInit:function(e){this.mescroll=e},downCallback:function(e){this.hasNext=!0,e.resetUpScroll()},upCallback:function(e){var t=this;return(0,s.default)(a.default.mark((function n(){var r,s;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={page:e.num,limit:e.size,sort:"addtime",order:"desc",userid:t.user.id},t.status&&(r["status"]=t.status),n.next=4,t.$api.list("orders",r);case 4:s=n.sent,1==e.num&&(t.list=[]),t.list=t.list.concat(s.data.list),0==s.data.list.length&&(t.hasNext=!1),e.endSuccess(e.size,t.hasNext);case 9:case"end":return n.stop()}}),n)})))()},onCancelTap1:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"提示",content:"是否确认退款",success:function(){var n=(0,s.default)(a.default.mark((function n(r){var s,c;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=e.getStorageSync("nowTable"),!r.confirm){n.next=18;break}return t.status="已退款",n.next=5,u.$api.update("orders",t);case 5:return c=n.sent,n.next=8,u.$api.info(t.tablename,t.goodid);case 8:if(c=n.sent,0!=c.code){n.next=14;break}return c.data.alllimittimes&&(c.data.alllimittimes=Number(c.data.alllimittimes)+Number(t.buynumber)),c.data.jf&&(u.user.jf=Number(u.user.jf)-Number(t.total)),n.next=14,u.$api.update(t.tablename,c.data);case 14:u.hasNext=!0,u.mescroll&&u.mescroll.resetUpScroll(),1==t.type||3==t.type?u.user.money=Number(u.user.money)+Number(t.total):2==t.type&&(u.user.jf=Number(u.user.jf)+Number(t.total)),u.$api.update(s,u.user);case 18:case"end":return n.stop()}}),n)})));function r(e){return n.apply(this,arguments)}return r}()});case 2:case"end":return r.stop()}}),r)})))()},onCancelTap:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"提示",content:"确定要申请退款",success:function(){var n=(0,s.default)(a.default.mark((function n(r){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getStorageSync("nowTable"),!r.confirm){n.next=11;break}return console.log("是"),t.sfsh="待审核",t.role=e.getStorageSync("nowTable"),n.next=7,u.$api.update("orders",t);case 7:n.sent,u.$utils.msg("退款申请已提交"),u.hasNext=!0,u.mescroll&&u.mescroll.resetUpScroll();case 11:case"end":return n.stop()}}),n)})));function r(e){return n.apply(this,arguments)}return r}()});case 2:case"end":return r.stop()}}),r)})))()},orderDiscuss:function(e){this.$utils.jump("../discuss"+e.tablename+"/add-or-update?refid="+e.goodid)},logistics:function(e){this.$utils.jump("./logistics?id="+e.id)},returnGood:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"是否退货?",content:"退货审核通过后,金额将返回账户中",success:function(){var n=(0,s.default)(a.default.mark((function n(r){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.sfsh="待审核",t.role=e.getStorageSync("nowTable"),n.next=4,u.$api.update("orders",t);case 4:u.$utils.msg("申请已提交");case 5:case"end":return n.stop()}}),n)})));function r(e){return n.apply(this,arguments)}return r}()});case 2:case"end":return r.stop()}}),r)})))()},cancelGroup:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"提示",content:"是否取消拼团",success:function(){var n=(0,s.default)(a.default.mark((function n(r){var s,c,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=e.getStorageSync("nowTable"),!r.confirm){n.next=19;break}return n.next=4,u.$api.info(t.tablename,t.goodid);case 4:return c=n.sent,o=c.data,o.curpeople=o.curpeople-1,n.next=9,u.$api.update(t.tablename,o);case 9:return c=n.sent,t.status="已退款",n.next=13,u.$api.update("orders",t);case 13:c=n.sent,u.hasNext=!0,u.mescroll&&u.mescroll.resetUpScroll(),u.user.money=Number(u.user.money)+Number(t.total),o.jf&&(u.user.jf=Number(u.user.jf)-Number(t.total)),u.$api.update(s,u.user);case 19:case"end":return n.stop()}}),n)})));function r(e){return n.apply(this,arguments)}return r}()});case 2:case"end":return r.stop()}}),r)})))()},cancel:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"提示",content:"是否取消订单",success:function(){var e=(0,s.default)(a.default.mark((function e(n){var r;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n.confirm){e.next=15;break}return t.status="已取消",e.next=4,u.$api.update("orders",t);case 4:if(r=e.sent,"shangpin"!=t.tablename){e.next=13;break}return e.next=8,u.$api.info(t.tablename,t.goodid);case 8:if(r=e.sent,0!=r.code){e.next=13;break}return r.data.alllimittimes=r.data.alllimittimes+t.buynumber,e.next=13,u.$api.update(t.tablename,r.data);case 13:u.hasNext=!0,u.mescroll&&u.mescroll.resetUpScroll();case 15:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()});case 2:case"end":return r.stop()}}),r)})))()},pay:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u,c;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,c=e.getStorageSync("nowTable"),e.showModal({title:"提示",content:"是否支付订单",success:function(){var e=(0,s.default)(a.default.mark((function e(n){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n.confirm){e.next=25;break}if(1!=t.type){e.next=12;break}if(!(u.user.money-t.total<0)){e.next=5;break}return u.$utils.msg("余额不足，请先充值"),e.abrupt("return");case 5:return u.$utils.msgBack("支付成功"),u.user.money=u.user.money-t.total,(u.user.jf||0==u.user.jf)&&(u.user.jf=parseFloat(u.user.jf)+parseFloat(t.total)),e.next=10,u.$api.update(c,u.user);case 10:e.next=20;break;case 12:if(2!=t.type){e.next=20;break}if(!(u.user.jf-t.total<0)){e.next=16;break}return u.$utils.msg("积分不足，兑换商品失败"),e.abrupt("return");case 16:return u.$utils.msgBack("兑换成功"),u.user.jf=u.user.jf-t.total,e.next=20,u.$api.update(c,u.user);case 20:return t.status="已支付",e.next=23,u.$api.update("orders",t);case 23:e.sent,u.mescroll&&u.mescroll.resetUpScroll();case 25:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()});case 3:case"end":return r.stop()}}),r)})))()},onConfirm:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"提示",content:"是否确认收货",success:function(){var n=(0,s.default)(a.default.mark((function n(r){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.getStorageSync("nowTable"),!r.confirm){n.next=8;break}return t.status="已完成",n.next=5,u.$api.update("orders",t);case 5:n.sent,u.hasNext=!0,u.mescroll&&u.mescroll.resetUpScroll();case 8:case"end":return n.stop()}}),n)})));function r(e){return n.apply(this,arguments)}return r}()});case 2:case"end":return r.stop()}}),r)})))()},del:function(t){var n=this;return(0,s.default)(a.default.mark((function r(){var u;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=n,e.showModal({title:"提示",content:"是否确认删除",success:function(){var e=(0,s.default)(a.default.mark((function e(n){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n.confirm){e.next=6;break}return e.next=3,u.$api.del("orders",JSON.stringify([t]));case 3:e.sent,u.mescroll&&u.mescroll.resetUpScroll(),u.$utils.msg("删除成功");case 6:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()});case 2:case"end":return r.stop()}}),r)})))()}}};t.default=u}).call(this,n(2)["default"])},161:function(e,t,n){"use strict";n.r(t);var r=n(162),a=n.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(s);t["default"]=a.a},162:function(e,t,n){}},[[155,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/shop-order/shop-order.js.map